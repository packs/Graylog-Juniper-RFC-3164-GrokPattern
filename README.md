# Graylog-Juniper-RFC-3164-GrokPattern
These extractors are for the various kinds of log messages generated by Juniper SRX devices running JunOS. These
logs are generated using the "default-log-log" (RFC 3164 compliant) format.

## Example Juniper JunOS traffic logs
```
Nov 4 16:23:09 cixi RT_FLOW : RT_FLOW_SESSION_CREATE: session created 50.0.0.100/24065->30.0.0.100/768 icmp 50.0.0.100/24065->30.0.0.100/768 None None 1 alg-policy untrust trust 100000165 N/A(N/A) reth2.0 UNKNOWN UNKNOWN UNKNOWN
Nov 4 16:23:09 cixi RT_FLOW : RT_FLOW_SESSION_CLOSE: session closed idle Timeout: 50.0.0.100/59963->30.0.0.100/53 junos-dns-udp 50.0.0.100/59963->10.1.1./53 N/A N/A static rule NAT_PUBLIC-DNS 17 FW_POLICY UNTRUST TRUST 100000165 1(71) 1(71) 60 UNKNOWN UNKNOWN N/A(N/A) reth8.2272 UNKNOWN 
Nov 4 16:23:09 cixi RPD_OSPF_NBRUP: OSPF neighbor 10.0.0.1 (realm ospf-v2 reth1.0100 area 0.0.0.0) state changed from Exchange to Full due to ExchangeDone (event reason: DBD exchange of master completed)
```

## Grok Extractors

### Session Logging
#### RT_FLOW_SESSION_CREATE
```
grok_pattern: %{WORD:state}: session closed %{JUNOS_REASON:reason}: %{IP:src_addr}/%{NUMBER:src_port}->%{IP:dst_addr}/%{NUMBER:dst_port} %{WORD:service} %{IP:src_addr_nat}/%{NUMBER:src_port_nat}->%{IP:dst_addr_nat}/%{NUMBER:dst_port_nat} %{WORD:src_nat_rule} %{WORD:dst_nat_rule} %{NUMBER:proto_id} %{WORD:policy} %{WORD:src_zone} %{WORD:dst_zone} %{NUMBER:session_id} %{NUMBER}\(%{NUMBER}\) %{NUMBER}\(%{NUMBER}\) %{NUMBER} %{WORD:application} %{WORD:nested-application} %{WORD}\(%{WORD}\) %{WORD:interface}
```

#### RT_FLOW_SESSION_CLOSE
```
grok_pattern: %{WORD:state}: session closed %{JUNOS_REASON:reason}: %{IP:src_addr}/%{NUMBER:src_port}->%{IP:dst_addr}/%{NUMBER:dst_port} %{JUNOS_SERVICE:service} %{IP:src_addr_nat}/%{NUMBER:src_port_nat}->%{IP:dst_addr_nat}/%{NUMBER:dst_port_nat} %{WORD:src_nat_rule} %{WORD:dst_nat_rule} %{WORD} %{WORD} %{JUNOS_NAT_RULE:nat_rule_name} %{NUMBER:proto_id} %{WORD:policy} %{WORD:src_zone} %{WORD:dst_zone} %{NUMBER:session_id} %{NUMBER}\(%{NUMBER}\) %{NUMBER}\(%{NUMBER}\) %{NUMBER} %{WORD:application} %{WORD:nested_application} %{WORD}\(%{WORD}\) %{JUNOS_INTERFACE:interface}
```

### OSPF Events
```
grok_pattern: RPD_OSPF_NBRUP: OSPF neighbor %{IP:neighbor-address} \(realm %{WORD:ospf-realm} %{INTERFACE:interface} area %{IP:area-idi}\) state changed from %{WORD:old-state} to %{WORD:new-state} due to %{WORD:event-name} \(event reason: %{JUNOS_REASON:reason}\)
```

### Referenced Patterns
```
JUNOS_REASON ([\s\w\/-]+)
JUNOS_SERVICE (\b[\w\/-]+\b)
WORD (\b[\w\/-]+\b)
JUNOS_NAT_RULE ([\w\/-]+)
JUNOS_INTERFACE (\b[\w0-9\.\/-]+\b)
```
